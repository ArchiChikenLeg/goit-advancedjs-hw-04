{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '53279240-6e40a1d36b66aedd6bbd928de';\nconst BASE_URL = 'https://pixabay.com/api/';\n\n/**\n\n * @param {Object} options \n * @param {string} options.query \n * @param {number} [options.page=1] \n * @param {number} [options.per_page=15] \n * @returns {Promise<Object>} \n */\nexport const searchImages = async ({ query, page = 1, per_page = 15 }) => {\n  try {\n    const response = await axios.get(BASE_URL, {\n      params: {\n        key: API_KEY,\n        q: query,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: 'true',\n        page,\n        per_page,\n      },\n    });\n\n    return response.data;\n  } catch (error) {\n    console.error('Error fetching images with axios:', error);\n    throw error;\n  }\n};\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nlet lightbox = null;\n\n/**\n * Создает HTML разметку для карточки изображения\n * @param {Object} image - объект с данными изображения\n * @returns {string} - HTML разметка карточки\n */\nconst createImageCard = (image) => {\n  const {\n    webformatURL,\n    largeImageURL,\n    tags,\n    likes,\n    views,\n    comments,\n    downloads,\n  } = image;\n\n  return `\n    <li class=\"gallery-item\">\n      <a class=\"gallery-link\" href=\"${largeImageURL}\">\n        <img\n          class=\"gallery-image\"\n          src=\"${webformatURL}\"\n          alt=\"${tags}\"\n          loading=\"lazy\"\n        />\n      </a>\n      <div class=\"image-info\">\n        <div class=\"info-item\">\n          <span class=\"info-label\">Likes</span>\n          <span class=\"info-value\">${likes}</span>\n        </div>\n        <div class=\"info-item\">\n          <span class=\"info-label\">Views</span>\n          <span class=\"info-value\">${views}</span>\n        </div>\n        <div class=\"info-item\">\n          <span class=\"info-label\">Comments</span>\n          <span class=\"info-value\">${comments}</span>\n        </div>\n        <div class=\"info-item\">\n          <span class=\"info-label\">Downloads</span>\n          <span class=\"info-value\">${downloads}</span>\n        </div>\n      </div>\n    </li>\n  `;\n};\n\n/**\n\n * @param {Array} images \n * @param {HTMLElement} galleryElement\n */\nexport const renderGallery = (images, galleryElement, { append = false } = {}) => {\n  const markup = images.map((image) => createImageCard(image)).join('');\n\n  if (append) {\n    galleryElement.insertAdjacentHTML('beforeend', markup);\n  } else {\n    galleryElement.innerHTML = markup;\n  }\n\n\n  if (lightbox) {\n    lightbox.refresh();\n  } else {\n    lightbox = new SimpleLightbox('.gallery-link', {\n      captions: true,\n      captionsData: 'alt',\n      docClose: true,\n      scrollZoom: true,\n    });\n  }\n};\n\n/**\n\n * @param {HTMLElement} galleryElement \n */\nexport const clearGallery = (galleryElement) => {\n  galleryElement.innerHTML = '';\n};\n\n/**\n\n * @param {HTMLElement} loaderElement \n */\nexport const showLoader = (loaderElement) => {\n  loaderElement.style.display = 'block';\n};\n\n/**\n * @param {HTMLElement} loaderElement \n */\nexport const hideLoader = (loaderElement) => {\n  loaderElement.style.display = 'none';\n};\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport { searchImages } from './js/pixabay-api';\nimport { renderGallery, clearGallery, showLoader, hideLoader } from './js/render-functions';\n\n\nconst searchForm = document.querySelector('.search-form');\nconst galleryElement = document.querySelector('.gallery');\nconst loaderElement = document.querySelector('.loader');\nconst loadMoreBtn = document.querySelector('.load-more');\n\n\nlet currentQuery = '';\nlet page = 1;\nconst perPage = 15;\nlet totalHits = 0;\n\n\nconst handleFormSubmit = async (event) => {\n  event.preventDefault();\n\n  const searchInput = searchForm.querySelector('input[name=\"searchQuery\"]');\n  const query = searchInput.value.trim();\n\n\n  if (!query) {\n    iziToast.warning({\n      title: 'Warning',\n      message: 'Please enter a search query',\n      position: 'topRight',\n      timeout: 3000,\n    });\n    return;\n  }\n\n  clearGallery(galleryElement);\n\n  currentQuery = query;\n  page = 1;\n  totalHits = 0;\n  loadMoreBtn.style.display = 'none';\n  showLoader(loaderElement);\n\n  try {\n\n    const data = await searchImages({ query, page, per_page: perPage });\n\n    hideLoader(loaderElement);\n\n\n    if (data.hits.length === 0) {\n      iziToast.error({\n        title: 'No Results',\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        position: 'topRight',\n        timeout: 4000,\n      });\n      searchInput.value = '';\n      return;\n    }\n\n\n    renderGallery(data.hits, galleryElement, { append: false });\n    totalHits = data.totalHits || 0;\n\n\n    if (totalHits > page * perPage) {\n      loadMoreBtn.style.display = 'inline-block';\n    } else {\n      loadMoreBtn.style.display = 'none';\n    }\n    searchInput.value = '';\n  } catch (error) {\n    hideLoader(loaderElement);\n    console.error('Error:', error);\n    iziToast.error({\n      title: 'Error',\n      message: 'Failed to fetch images. Please try again!',\n      position: 'topRight',\n      timeout: 4000,\n    });\n  }\n};\n\n\nsearchForm.addEventListener('submit', handleFormSubmit);\n\nloadMoreBtn.addEventListener('click', async () => {\n  if (!currentQuery) return;\n\n  page += 1;\n  loadMoreBtn.style.display = 'none';\n  showLoader(loaderElement);\n\n  try {\n    const data = await searchImages({ query: currentQuery, page, per_page: perPage });\n    hideLoader(loaderElement);\n\n    if (data.hits.length > 0) {\n      renderGallery(data.hits, galleryElement, { append: true });\n\n      const firstCard = galleryElement.querySelector('.gallery-item');\n      if (firstCard) {\n        const { height } = firstCard.getBoundingClientRect();\n        window.scrollBy({ top: height * 2, behavior: 'smooth' });\n      }\n    }\n\n    totalHits = data.totalHits || totalHits;\n\n    if (page * perPage >= totalHits) {\n\n      loadMoreBtn.style.display = 'none';\n      iziToast.info({\n        title: 'End',\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n        timeout: 4000,\n      });\n    } else {\n      loadMoreBtn.style.display = 'inline-block';\n    }\n  } catch (error) {\n    hideLoader(loaderElement);\n    console.error('Load more error:', error);\n    iziToast.error({\n      title: 'Error',\n      message: 'Failed to load more images. Please try again!',\n      position: 'topRight',\n      timeout: 4000,\n    });\n  }\n});\n"],"names":["API_KEY","BASE_URL","searchImages","query","page","per_page","axios","error","lightbox","createImageCard","image","webformatURL","largeImageURL","tags","likes","views","comments","downloads","renderGallery","images","galleryElement","append","markup","SimpleLightbox","clearGallery","showLoader","loaderElement","hideLoader","searchForm","loadMoreBtn","currentQuery","perPage","totalHits","handleFormSubmit","event","searchInput","iziToast","data","firstCard","height"],"mappings":"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"}